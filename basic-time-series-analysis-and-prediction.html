<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 32 Basic time series analysis and prediction | Community Contributions STAT GR 5293</title>
<meta name="description" content="Dexin Sun This is a tutorial for time series and prediction. The process of building a time series model and how to do the analysis will be covered.  32.1 Motivation Time series analysis is a...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 32 Basic time series analysis and prediction | Community Contributions STAT GR 5293">
<meta property="og:type" content="book">
<meta property="og:description" content="Dexin Sun This is a tutorial for time series and prediction. The process of building a time series model and how to do the analysis will be covered.  32.1 Motivation Time series analysis is a...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 32 Basic time series analysis and prediction | Community Contributions STAT GR 5293">
<meta name="twitter:description" content="Dexin Sun This is a tutorial for time series and prediction. The process of building a time series model and how to do the analysis will be covered.  32.1 Motivation Time series analysis is a...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><link href="libs/parallel-coordinates-2.1.8/parcoords.css" rel="stylesheet">
<script src="libs/parcoords-binding-1.0.0/parcoords.js"></script><script src="libs/d3-5.16.0/d3.min.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script><script src="libs/echarts-4.0.0/echarts.min.js"></script><script src="libs/echarts-4.0.0/echarts-wordcloud.min.js"></script><script src="libs/echarts_shapeFile-3.2.2/china.js"></script><script src="libs/echarts_shapeFile-3.2.2/provinceShape.js"></script><script src="libs/echarts_shapeFile-3.2.2/world.js"></script><script src="libs/echarts-binding-0.0.4/echarts.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Community Contributions STAT GR 5293</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="community-contribution.html"><span class="header-section-number">2</span> Community Contribution</a></li>
<li><a class="" href="github-submission-instructions.html"><span class="header-section-number">3</span> GitHub submission instructions</a></li>
<li><a class="" href="sample-project.html"><span class="header-section-number">4</span> Sample project</a></li>
<li class="book-part">Cheatsheets</li>
<li><a class="" href="tmap-package.html"><span class="header-section-number">5</span> tmap package</a></li>
<li><a class="" href="graphics-cheatsheet-in-ggplot2.html"><span class="header-section-number">6</span> Graphics cheatsheet in ggplot2</a></li>
<li><a class="" href="ggplot2-cheatsheet.html"><span class="header-section-number">7</span> ggplot2 cheatsheet</a></li>
<li><a class="" href="data-preprocessing-cheat-sheet-in-r.html"><span class="header-section-number">8</span> Data preprocessing cheat sheet in R</a></li>
<li><a class="" href="data-wrangling-and-visualization-in-r.html"><span class="header-section-number">9</span> Data Wrangling and Visualization in R</a></li>
<li><a class="" href="ggplot2-cheatsheet-1.html"><span class="header-section-number">10</span> GGplot2 cheatsheet</a></li>
<li><a class="" href="cheat-sheet-for-tidyverse.html"><span class="header-section-number">11</span> Cheat Sheet for Tidyverse</a></li>
<li><a class="" href="memos-checklist-and-usful-links-experience-of-statistical-graphic.html"><span class="header-section-number">12</span> Memos, checklist and usful links: experience of statistical graphic</a></li>
<li><a class="" href="cheatsheet-for-multiple-graphics.html"><span class="header-section-number">13</span> Cheatsheet for multiple graphics</a></li>
<li><a class="" href="useful-setting-of-ggplot2.html"><span class="header-section-number">14</span> Useful setting of ggplot2</a></li>
<li><a class="" href="cheatsheet-for-circlize-package.html"><span class="header-section-number">15</span> Cheatsheet for ‘circlize’ package</a></li>
<li class="book-part">Tutorials</li>
<li><a class="" href="visualizing-geographical-time-series-data-with-messy-country-name.html"><span class="header-section-number">16</span> Visualizing Geographical Time Series Data With Messy Country Name</a></li>
<li><a class="" href="plotly-package.html"><span class="header-section-number">17</span> Plotly package</a></li>
<li><a class="" href="web-scraping-using-beautifulsoup-in-python.html"><span class="header-section-number">18</span> Web Scraping Using BeautifulSoup in Python</a></li>
<li><a class="" href="a-brief-guide-through-ggplot-via-examples.html"><span class="header-section-number">19</span> A Brief Guide Through ggplot via Examples</a></li>
<li><a class="" href="drawing-five-common-plots-by-ggplot2.html"><span class="header-section-number">20</span> Drawing Five Common Plots by ggplot2</a></li>
<li><a class="" href="compare-different-ways-of-plotting-biplot-mosaicplot-and-heatmap.html"><span class="header-section-number">21</span> Compare different ways of plotting Biplot, Mosaicplot, and Heatmap</a></li>
<li><a class="" href="twitter-api-guide-in-r.html"><span class="header-section-number">22</span> Twitter API guide in R</a></li>
<li><a class="" href="geographical-maps-packages-comparison-ggmap-vs.-ggplot-vs-tmap.html"><span class="header-section-number">23</span> Geographical Maps Packages Comparison: ggmap vs. ggplot vs tmap</a></li>
<li><a class="" href="r-shiny-map-tutorial.html"><span class="header-section-number">24</span> R Shiny Map Tutorial</a></li>
<li><a class="" href="animation-graphs-in-plot_ly-and-gganimate.html"><span class="header-section-number">25</span> Animation graphs in plot_ly and gganimate</a></li>
<li><a class="" href="forest-plots.html"><span class="header-section-number">26</span> Forest Plots</a></li>
<li><a class="" href="differences-between-some-packages-of-visualizaiton.html"><span class="header-section-number">27</span> Differences between some packages of visualizaiton</a></li>
<li><a class="" href="lecture-helper.html"><span class="header-section-number">28</span> Lecture Helper</a></li>
<li><a class="" href="basic-introduction-to-tidyverse.html"><span class="header-section-number">29</span> Basic introduction to tidyverse</a></li>
<li><a class="" href="class_material_code_throughout_this_semester.html"><span class="header-section-number">30</span> class_material_code_throughout_this_semester</a></li>
<li><a class="" href="calendar-heat-map-tutorial.html"><span class="header-section-number">31</span> Calendar heat map tutorial</a></li>
<li><a class="active" href="basic-time-series-analysis-and-prediction.html"><span class="header-section-number">32</span> Basic time series analysis and prediction</a></li>
<li><a class="" href="r-shiny-and-interactive-map-tutorial.html"><span class="header-section-number">33</span> R Shiny and Interactive Map Tutorial</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="github-initial-setup.html"><span class="header-section-number">34</span> Github initial setup</a></li>
<li><a class="" href="tutorial-for-pull-request-mergers.html"><span class="header-section-number">35</span> Tutorial for pull request mergers</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jtr13/cc22spring">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="basic-time-series-analysis-and-prediction" class="section level1" number="32">
<h1>
<span class="header-section-number">32</span> Basic time series analysis and prediction<a class="anchor" aria-label="anchor" href="#basic-time-series-analysis-and-prediction"><i class="fas fa-link"></i></a>
</h1>
<p>Dexin Sun</p>
<p>This is a tutorial for time series and prediction. The process of building a time series model and how to do the analysis will be covered.</p>
<div id="motivation-5" class="section level2" number="32.1">
<h2>
<span class="header-section-number">32.1</span> Motivation<a class="anchor" aria-label="anchor" href="#motivation-5"><i class="fas fa-link"></i></a>
</h2>
<p>Time series analysis is a method to show the relationship between a variable and time. We usually use Yt as the value based on time t. The main purpose of time series analysis is to do the prediction based on historical data. This tutorial will focus on how to build a time series model and do the prediction.</p>
</div>
<div id="data-input" class="section level2" number="32.2">
<h2>
<span class="header-section-number">32.2</span> Data input<a class="anchor" aria-label="anchor" href="#data-input"><i class="fas fa-link"></i></a>
</h2>
<p>We use the dataset in R call “sunspot.month”. This is a monthly numbers of sunspots, as from the World Data Center.</p>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://eigenmath.org/itsmr-refman.pdf">itsmr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/">forecast</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sunspot.month"</span><span class="op">)</span></code></pre></div>
</div>
<div id="time-series-plot" class="section level2" number="32.3">
<h2>
<span class="header-section-number">32.3</span> Time series plot<a class="anchor" aria-label="anchor" href="#time-series-plot"><i class="fas fa-link"></i></a>
</h2>
<p>First, we could use “plot.ts()” to show the time series plot, this is a direct way to show the relationship between a variable and time.</p>
<p>Most of time series model could be divide into 3 components: stationary series, trend, seasonal variation. Definition of Stationary Series is that joint probability distributions do not change with time or expectation and variance do not change with time, meaning that statistical value fluctuates up and down a constant and the fluctuation range is bounded.</p>
<p>For example, in the plot below, we could find that it is a model with seasonality but the trend is not obvious. And stationary series is what we could choose a model to fit.</p>
<p>The autocorrelation coefficient ACF characterizes the correlation coefficient between yt and the lag k-order Y(t-k), and the partial autocorrelation coefficient PACF characterizes the removal of the Y(t-1), Y(t-2) equivalent pair Y(t-k) after the impact of the correlation coefficient. ACF and PACF could show the stationary of model. Both of them are shown, as follows:</p>
<div class="sourceCode" id="cb403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html">plot.ts</a></span><span class="op">(</span><span class="va">sunspot.month</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="basic_time_series_analysis_and_prediction_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">sunspot.month</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="basic_time_series_analysis_and_prediction_files/figure-html/unnamed-chunk-3-2.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">sunspot.month</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="basic_time_series_analysis_and_prediction_files/figure-html/unnamed-chunk-3-3.png" width="672" style="display: block; margin: auto;"></div>
<p>To get stationary series, we need to remove trend and seasonal variation. There are two common ways: Smoothing and differencing. Smoothing is a way to get the function of trend and seasonality, which is hard to find. Differencing is what we will focus in this tutorial.</p>
</div>
<div id="differencing" class="section level2" number="32.4">
<h2>
<span class="header-section-number">32.4</span> Differencing<a class="anchor" aria-label="anchor" href="#differencing"><i class="fas fa-link"></i></a>
</h2>
<p>We could use “adf.test()” to verify whether we need to differencing. “ndiffs()” could show the difference order.</p>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/adf.test.html">adf.test</a></span><span class="op">(</span><span class="va">sunspot.month</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  sunspot.month
## Dickey-Fuller = -7.0245, Lag order = 14, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
<div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/ndiffs.html">ndiffs</a></span><span class="op">(</span><span class="va">sunspot.month</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newST</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">sunspot.month</span>,<span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html">plot.ts</a></span><span class="op">(</span><span class="va">newST</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="basic_time_series_analysis_and_prediction_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb411"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">newST</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="basic_time_series_analysis_and_prediction_files/figure-html/unnamed-chunk-5-2.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">newST</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="basic_time_series_analysis_and_prediction_files/figure-html/unnamed-chunk-5-3.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="stationary-series-model" class="section level2" number="32.5">
<h2>
<span class="header-section-number">32.5</span> Stationary series model<a class="anchor" aria-label="anchor" href="#stationary-series-model"><i class="fas fa-link"></i></a>
</h2>
<p>There are three common stationary series models:</p>
<p>AR(p): Autoregression. The evolving variable of interest is regressed on its own lagged values.</p>
<p>MA(q): Moving Average. The regression error is actually a linear combination of error terms whose values occurred contemporaneously and at various times in the past.</p>
<p>ARMA(p,q): Autoregressive moving average. AR+MA</p>
<p>The model without differencing is ARIMA(p,d,q) model, where:</p>
<p>I: Integrated. The data values have been replaced with the difference between their values and the previous values.</p>
<p>p: The order (number of time lags) of the autoregressive model</p>
<p>d:The degree of differencing</p>
<p>q: The order of the moving-average model</p>
<p>From the figure above, it can be seen that the sequence after the differencing becomes a stationary sequence. And the autocorrelation graph shows that the autocorrelation coefficient quickly decreases to 0 after lagging 1 order, which further shows that the series is stable. According to the figure below, the sequence after the differencing applies to ARIMA(5,1,2). And ARIMA(5,1,2) could be the beginning parameter, and based on the beginning parameter we could do some small adjustment to gain the best model.</p>
<div class="sourceCode" id="cb413"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sunspot.month</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,method<span class="op">=</span><span class="st">"ML"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = sunspot.month, order = c(5, 1, 2), method = "ML")
## 
## Coefficients:
##           ar1      ar2      ar3      ar4      ar5     ma1      ma2
##       -0.5212  -0.2156  -0.1722  -0.0812  -0.0498  0.1113  -0.1250
## s.e.   0.2677   0.2113   0.1044   0.0699   0.0359  0.2677   0.1908
## 
## sigma^2 estimated as 252.1:  log likelihood = -13287.92,  aic = 26591.84</code></pre>
<div class="sourceCode" id="cb415"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sunspot.month</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,method<span class="op">=</span><span class="st">"ML"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = sunspot.month, order = c(4, 1, 2), method = "ML")
## 
## Coefficients:
##          ar1      ar2      ar3      ar4     ma1      ma2
##       -0.197  -0.0578  -0.0672  -0.0101  -0.213  -0.1488
## s.e.     NaN      NaN   0.0209   0.0264     NaN      NaN
## 
## sigma^2 estimated as 252.3:  log likelihood = -13289.34,  aic = 26592.67</code></pre>
<div class="sourceCode" id="cb417"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sunspot.month</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,method<span class="op">=</span><span class="st">"ML"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = sunspot.month, order = c(3, 1, 2), method = "ML")
## 
## Coefficients:
##           ar1      ar2      ar3      ma1      ma2
##       -0.1889  -0.0398  -0.0582  -0.2208  -0.1636
## s.e.      NaN      NaN      NaN      NaN      NaN
## 
## sigma^2 estimated as 252.3:  log likelihood = -13289.41,  aic = 26590.82</code></pre>
<div class="sourceCode" id="cb419"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sunspot.month</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,method<span class="op">=</span><span class="st">"ML"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = sunspot.month, order = c(2, 1, 2), method = "ML")
## 
## Coefficients:
##          ar1      ar2      ma1     ma2
##       1.3304  -0.3805  -1.7581  0.7979
## s.e.  0.0289   0.0272   0.0198  0.0186
## 
## sigma^2 estimated as 246.3:  log likelihood = -13251.08,  aic = 26512.17</code></pre>
<div class="sourceCode" id="cb421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sunspot.month</span>,order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,method<span class="op">=</span><span class="st">"ML"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = sunspot.month, order = c(1, 1, 2), method = "ML")
## 
## Coefficients:
##           ar1      ma1      ma2
##       -0.0099  -0.3995  -0.1246
## s.e.   0.1104   0.1089   0.0538
## 
## sigma^2 estimated as 252.7:  log likelihood = -13291.64,  aic = 26591.28</code></pre>
<p>Compared all AIC value above, we could find that ARIMA(2,1,2) has the smallest model. Therefore, ARIMA(2,1,2) would be the fittest model.</p>
<p>Or “auto.arima” could be use to find the fittest model, which is a easier method:</p>
<div class="sourceCode" id="cb423"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/auto.arima.html">auto.arima</a></span><span class="op">(</span><span class="va">sunspot.month</span><span class="op">)</span></code></pre></div>
<pre><code>## Series: sunspot.month 
## ARIMA(2,1,2) 
## 
## Coefficients:
##          ar1      ar2      ma1     ma2
##       1.3307  -0.3807  -1.7582  0.7979
## s.e.  0.0289   0.0272   0.0198  0.0186
## 
## sigma^2 = 246.6:  log likelihood = -13251.08
## AIC=26512.17   AICc=26512.19   BIC=26542.48</code></pre>
</div>
<div id="testing" class="section level2" number="32.6">
<h2>
<span class="header-section-number">32.6</span> Testing<a class="anchor" aria-label="anchor" href="#testing"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TSmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/auto.arima.html">auto.arima</a></span><span class="op">(</span><span class="va">sunspot.month</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">TSmodel</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  TSmodel$residuals
## W = 0.96263, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/box.test.html">Box.test</a></span><span class="op">(</span><span class="va">TSmodel</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  TSmodel$residuals
## X-squared = 0.16254, df = 1, p-value = 0.6868</code></pre>
<p>The parameter test includes two tests: the significance test of the parameters and the normality and irrelevance test of the residuals. We could use “shapiro.test()” to check the normality of residuals and “Box.test()” to check the randomness of residuals. Since p-value of normality test is smaller than 0.05, stationary series is not a normal distribution.</p>
</div>
<div id="prediction" class="section level2" number="32.7">
<h2>
<span class="header-section-number">32.7</span> Prediction<a class="anchor" aria-label="anchor" href="#prediction"><i class="fas fa-link"></i></a>
</h2>
<p>Since the first-order differencing was originally made, it is necessary to restore the first-order differencing for prediction when making predictions. “forecast()” could be used to do the prediction.</p>
<div class="sourceCode" id="cb429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/itsmr/man/forecast.html">forecast</a></span><span class="op">(</span><span class="va">TSmodel</span>,<span class="fl">50</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pre</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="basic_time_series_analysis_and_prediction_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="reference-1" class="section level2" number="32.8">
<h2>
<span class="header-section-number">32.8</span> Reference<a class="anchor" aria-label="anchor" href="#reference-1"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average#Definition" class="uri">https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average#Definition</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="calendar-heat-map-tutorial.html"><span class="header-section-number">31</span> Calendar heat map tutorial</a></div>
<div class="next"><a href="r-shiny-and-interactive-map-tutorial.html"><span class="header-section-number">33</span> R Shiny and Interactive Map Tutorial</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#basic-time-series-analysis-and-prediction"><span class="header-section-number">32</span> Basic time series analysis and prediction</a></li>
<li><a class="nav-link" href="#motivation-5"><span class="header-section-number">32.1</span> Motivation</a></li>
<li><a class="nav-link" href="#data-input"><span class="header-section-number">32.2</span> Data input</a></li>
<li><a class="nav-link" href="#time-series-plot"><span class="header-section-number">32.3</span> Time series plot</a></li>
<li><a class="nav-link" href="#differencing"><span class="header-section-number">32.4</span> Differencing</a></li>
<li><a class="nav-link" href="#stationary-series-model"><span class="header-section-number">32.5</span> Stationary series model</a></li>
<li><a class="nav-link" href="#testing"><span class="header-section-number">32.6</span> Testing</a></li>
<li><a class="nav-link" href="#prediction"><span class="header-section-number">32.7</span> Prediction</a></li>
<li><a class="nav-link" href="#reference-1"><span class="header-section-number">32.8</span> Reference</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jtr13/cc22spring/blob/main/basic_time_series_analysis_and_prediction.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jtr13/cc22spring/edit/main/basic_time_series_analysis_and_prediction.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Community Contributions STAT GR 5293</strong>" was written by . It was last built on 2022-04-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
