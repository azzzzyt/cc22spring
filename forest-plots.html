<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 25 Forest Plots | Community Contributions STAT GR 5293</title>
<meta name="description" content="Shreya Rao  25.1 Introduction Forest Plots provide tabular and graphical information about estimates of comparisons or associations, corresponding precision, and statistical significance. A forest...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 25 Forest Plots | Community Contributions STAT GR 5293">
<meta property="og:type" content="book">
<meta property="og:description" content="Shreya Rao  25.1 Introduction Forest Plots provide tabular and graphical information about estimates of comparisons or associations, corresponding precision, and statistical significance. A forest...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 25 Forest Plots | Community Contributions STAT GR 5293">
<meta name="twitter:description" content="Shreya Rao  25.1 Introduction Forest Plots provide tabular and graphical information about estimates of comparisons or associations, corresponding precision, and statistical significance. A forest...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><link href="libs/parallel-coordinates-2.1.8/parcoords.css" rel="stylesheet">
<script src="libs/parcoords-binding-1.0.0/parcoords.js"></script><script src="libs/d3-5.16.0/d3.min.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script><script src="libs/echarts-4.0.0/echarts.min.js"></script><script src="libs/echarts-4.0.0/echarts-wordcloud.min.js"></script><script src="libs/echarts_shapeFile-3.2.2/china.js"></script><script src="libs/echarts_shapeFile-3.2.2/provinceShape.js"></script><script src="libs/echarts_shapeFile-3.2.2/world.js"></script><script src="libs/echarts-binding-0.0.4/echarts.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Community Contributions STAT GR 5293</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="community-contribution.html"><span class="header-section-number">2</span> Community Contribution</a></li>
<li><a class="" href="github-submission-instructions.html"><span class="header-section-number">3</span> GitHub submission instructions</a></li>
<li><a class="" href="sample-project.html"><span class="header-section-number">4</span> Sample project</a></li>
<li class="book-part">Cheatsheets</li>
<li><a class="" href="tmap-package.html"><span class="header-section-number">5</span> tmap package</a></li>
<li><a class="" href="graphics-cheatsheet-in-ggplot2.html"><span class="header-section-number">6</span> Graphics cheatsheet in ggplot2</a></li>
<li><a class="" href="ggplot2-cheatsheet.html"><span class="header-section-number">7</span> ggplot2 cheatsheet</a></li>
<li><a class="" href="data-preprocessing-cheat-sheet-in-r.html"><span class="header-section-number">8</span> Data preprocessing cheat sheet in R</a></li>
<li><a class="" href="data-wrangling-and-visualization-in-r.html"><span class="header-section-number">9</span> Data Wrangling and Visualization in R</a></li>
<li><a class="" href="ggplot2-cheatsheet-1.html"><span class="header-section-number">10</span> GGplot2 cheatsheet</a></li>
<li><a class="" href="cheat-sheet-for-tidyverse.html"><span class="header-section-number">11</span> Cheat Sheet for Tidyverse</a></li>
<li><a class="" href="memos-checklist-and-usful-links-experience-of-statistical-graphic.html"><span class="header-section-number">12</span> Memos, checklist and usful links: experience of statistical graphic</a></li>
<li><a class="" href="cheatsheet-for-multiple-graphics.html"><span class="header-section-number">13</span> Cheatsheet for multiple graphics</a></li>
<li><a class="" href="useful-setting-of-ggplot2.html"><span class="header-section-number">14</span> Useful setting of ggplot2</a></li>
<li class="book-part">Tutorials</li>
<li><a class="" href="visualizing-geographical-time-series-data-with-messy-country-name.html"><span class="header-section-number">15</span> Visualizing Geographical Time Series Data With Messy Country Name</a></li>
<li><a class="" href="plotly-package.html"><span class="header-section-number">16</span> Plotly package</a></li>
<li><a class="" href="web-scraping-using-beautifulsoup-in-python.html"><span class="header-section-number">17</span> Web Scraping Using BeautifulSoup in Python</a></li>
<li><a class="" href="a-brief-guide-through-ggplot-via-examples.html"><span class="header-section-number">18</span> A Brief Guide Through ggplot via Examples</a></li>
<li><a class="" href="drawing-five-common-plots-by-ggplot2.html"><span class="header-section-number">19</span> Drawing Five Common Plots by ggplot2</a></li>
<li><a class="" href="compare-different-ways-of-plotting-biplot-mosaicplot-and-heatmap.html"><span class="header-section-number">20</span> Compare different ways of plotting Biplot, Mosaicplot, and Heatmap</a></li>
<li><a class="" href="twitter-api-guide-in-r.html"><span class="header-section-number">21</span> Twitter API guide in R</a></li>
<li><a class="" href="geographical-maps-packages-comparison-ggmap-vs.-ggplot-vs-tmap.html"><span class="header-section-number">22</span> Geographical Maps Packages Comparison: ggmap vs.Â ggplot vs tmap</a></li>
<li><a class="" href="r-shiny-map-tutorial.html"><span class="header-section-number">23</span> R Shiny Map Tutorial</a></li>
<li><a class="" href="animation-graphs-in-plot_ly-and-gganimate.html"><span class="header-section-number">24</span> Animation graphs in plot_ly and gganimate</a></li>
<li><a class="active" href="forest-plots.html"><span class="header-section-number">25</span> Forest Plots</a></li>
<li><a class="" href="differences-between-some-packages-of-visualizaiton.html"><span class="header-section-number">26</span> Differences between some packages of visualizaiton</a></li>
<li><a class="" href="lecture-helper.html"><span class="header-section-number">27</span> Lecture Helper</a></li>
<li><a class="" href="basic-introduction-to-tidyverse.html"><span class="header-section-number">28</span> Basic introduction to tidyverse</a></li>
<li><a class="" href="class_material_code_throughout_this_semester.html"><span class="header-section-number">29</span> class_material_code_throughout_this_semester</a></li>
<li><a class="" href="calendar-heat-map-tutorial.html"><span class="header-section-number">30</span> Calendar heat map tutorial</a></li>
<li><a class="" href="basic-time-series-analysis-and-prediction.html"><span class="header-section-number">31</span> Basic time series analysis and prediction</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="github-initial-setup.html"><span class="header-section-number">32</span> Github initial setup</a></li>
<li><a class="" href="tutorial-for-pull-request-mergers.html"><span class="header-section-number">33</span> Tutorial for pull request mergers</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jtr13/cc22spring">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="forest-plots" class="section level1" number="25">
<h1>
<span class="header-section-number">25</span> Forest Plots<a class="anchor" aria-label="anchor" href="#forest-plots"><i class="fas fa-link"></i></a>
</h1>
<p>Shreya Rao</p>
<div id="introduction-3" class="section level2" number="25.1">
<h2>
<span class="header-section-number">25.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-3"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Forest Plots provide tabular and graphical information about estimates of comparisons or associations, corresponding precision, and statistical significance.</li>
<li>A forest plot arrays point estimates (e.g., mean) and confidence intervals (e.g., 95% CI) represented by whiskers for multiple studies and/or multiple findings within a study in a horizontal orientation.</li>
<li>Explanatory text displayed next to these points and whisker diagrams provide details regarding the data being presented.</li>
<li>A vertical reference line is typically plotted at the null hypothesis, with the statistical significance of an individual point and whiskers compared to that reference line.</li>
<li>In cases where the data being compared are difference between means, the null is zero (0) and the x scales are normal. When a ratio (e.g., odds ratio) is being compared, the null has a value of 1 and the scales are logarithmic.</li>
</ul>
<p><strong>Example 1:</strong>
<img src="resources/forest_plot/SA_Cognitive.JPG"></p>
<p><strong>Example 2:</strong>
<img src="resources/forest_plot/wiki.PNG"></p>
</div>
<div id="data" class="section level2" number="25.2">
<h2>
<span class="header-section-number">25.2</span> Data<a class="anchor" aria-label="anchor" href="#data"><i class="fas fa-link"></i></a>
</h2>
<p>Assume a study conducted over a year from May 2020 to June 2021 collected the mortality rates of people along with socio-demographic and medical information. Researchers want to see if factors such as Sex, Socioeconomic condition, Period of the pandemic and Preexisting conditions influenced the mortality rate. To do so, they calculated the odds ratio of mortality rates of the factors with respect of a base factor within the four different categories.</p>
<p>After this analysis, the data looks like this:</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">or.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  factors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Female (ref)"</span>, <span class="st">"Male"</span>, 
              <span class="st">"High (ref)"</span>, <span class="st">"Low"</span>, 
              <span class="st">"Period 1 (05/17/2020-09/30/2020) (ref)"</span>, <span class="st">"Period 2 (10/01/2020-01/31/2021)"</span>,
         <span class="st">"Period 3 (02/01/2021-05/14/2021)"</span>, <span class="st">"Period 4 (05/14/2021-06/14/2021)"</span>, 
         <span class="st">"No comorbidity (ref)"</span>, <span class="st">"Diabetes"</span>, <span class="st">"Hypertension"</span>, <span class="st">"Chronic respiratory illness"</span>,   <span class="st">"Chronic renal disease"</span>, <span class="st">"Chronic liver disease"</span>, <span class="st">"Other"</span><span class="op">)</span>, 
  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"Sex"</span>, 
             <span class="st">"Socio-demographic factors"</span>, <span class="st">"Socio-demographic factors"</span>, 
             <span class="st">"Period of the pandemic"</span>, <span class="st">"Period of the pandemic"</span>,
         <span class="st">"Period of the pandemic"</span>, <span class="st">"Period of the pandemic"</span>, 
         <span class="st">"Preexisting conditions"</span>, <span class="st">"Preexisting conditions"</span>, <span class="st">"Preexisting conditions"</span>,
         <span class="st">"Preexisting conditions"</span>, <span class="st">"Preexisting conditions"</span>, <span class="st">"Preexisting conditions"</span>, <span class="st">"Preexisting conditions"</span><span class="op">)</span>,
  or <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1.15</span>, <span class="cn">NA</span>, <span class="fl">1.76</span>, <span class="cn">NA</span>, <span class="fl">0.90</span>, <span class="fl">0.84</span>, <span class="fl">6.09</span>, <span class="cn">NA</span>, <span class="fl">1.05</span>, <span class="fl">1.13</span>, <span class="fl">1.05</span>, <span class="fl">2.33</span>, <span class="fl">2.08</span>, <span class="fl">1.44</span><span class="op">)</span>,
  ll <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1.09</span>, <span class="cn">NA</span>, <span class="fl">1.56</span>, <span class="cn">NA</span>, <span class="fl">0.85</span>, <span class="fl">0.77</span>, <span class="fl">4.23</span>, <span class="cn">NA</span>, <span class="fl">0.97</span>, <span class="fl">1.04</span>, <span class="fl">0.92</span>, <span class="fl">2.04</span>, <span class="fl">1.57</span>, <span class="fl">1.29</span><span class="op">)</span>,
  ul <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1.22</span>, <span class="cn">NA</span>, <span class="fl">1.98</span>, <span class="cn">NA</span>, <span class="fl">0.95</span>, <span class="fl">0.91</span>, <span class="fl">8.23</span>, <span class="cn">NA</span>, <span class="fl">1.15</span>, <span class="fl">1.23</span>, <span class="fl">1.20</span>, <span class="fl">2.67</span>, <span class="fl">2.74</span>, <span class="fl">1.61</span><span class="op">)</span><span class="op">)</span>

<span class="va">or.df</span></code></pre></div>
<pre><code>##                                   factors                    groups   or   ll
## 1                            Female (ref)                       Sex   NA   NA
## 2                                    Male                       Sex 1.15 1.09
## 3                              High (ref) Socio-demographic factors   NA   NA
## 4                                     Low Socio-demographic factors 1.76 1.56
## 5  Period 1 (05/17/2020-09/30/2020) (ref)    Period of the pandemic   NA   NA
## 6        Period 2 (10/01/2020-01/31/2021)    Period of the pandemic 0.90 0.85
## 7        Period 3 (02/01/2021-05/14/2021)    Period of the pandemic 0.84 0.77
## 8        Period 4 (05/14/2021-06/14/2021)    Period of the pandemic 6.09 4.23
## 9                    No comorbidity (ref)    Preexisting conditions   NA   NA
## 10                               Diabetes    Preexisting conditions 1.05 0.97
## 11                           Hypertension    Preexisting conditions 1.13 1.04
## 12            Chronic respiratory illness    Preexisting conditions 1.05 0.92
## 13                  Chronic renal disease    Preexisting conditions 2.33 2.04
## 14                  Chronic liver disease    Preexisting conditions 2.08 1.57
## 15                                  Other    Preexisting conditions 1.44 1.29
##      ul
## 1    NA
## 2  1.22
## 3    NA
## 4  1.98
## 5    NA
## 6  0.95
## 7  0.91
## 8  8.23
## 9    NA
## 10 1.15
## 11 1.23
## 12 1.20
## 13 2.67
## 14 2.74
## 15 1.61</code></pre>
<p>Note that this dataset has the columns - factors, groups/categoies to which the factors belong to, odds ratio, lower limits of confidence interval and upper limits of confidence intervals of the odds ratio. The factors columns also indicates the reference factor of every group. The reference groups within each category has NA values for the odds ratio, lower and upper confidence level limits.</p>
<p>Just looking at the values in the table, we can not fully understand the nuances. To better understand this analysis, we need to make a forest plot. We will use the library <strong>forestplot</strong> to plot it.</p>
</div>
<div id="formatting" class="section level2" number="25.3">
<h2>
<span class="header-section-number">25.3</span> Formatting<a class="anchor" aria-label="anchor" href="#formatting"><i class="fas fa-link"></i></a>
</h2>
<p>The variables need to be formatted in a specific way to utilize the <em>forestplot()</em> function. Since we want to display the confidence intervals and or values, they can also be formatted appropriately.</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#formating confidence intervals as (ll, ul) and adding to dataset</span>
<span class="va">or.df</span><span class="op">$</span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">or.df</span><span class="op">$</span><span class="va">or</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">or.df</span><span class="op">$</span><span class="va">ll</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">or.df</span><span class="op">$</span><span class="va">ul</span><span class="op">)</span>, <span class="st">")"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span>

<span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"95% CI"</span>, 
        <span class="st">""</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="st">""</span>, <span class="co">#sex</span>
        <span class="st">""</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="st">""</span>, <span class="co">#socio-demographic</span>
        <span class="st">""</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="st">""</span>, <span class="co">#period</span>
        <span class="st">""</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>     <span class="co">#pre-existing condition</span>
        <span class="op">)</span></code></pre></div>
<p>To make the plot more presentable, we want to separates the factor categories from each other by adding a blank line after each category. To do so in <em>forestplot()</em>, we add an empty string to character vectors and NA values to numeric vectors.</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#adding NA values and factor categories to or, upper limit and lower limit vectors</span>

<span class="co">#formatting OR values that are displayed on graph</span>
<span class="va">or.char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OR"</span>, 
        <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">or.df</span><span class="op">$</span><span class="va">or</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">""</span>, <span class="co">#sex</span>
        <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">or.df</span><span class="op">$</span><span class="va">or</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="st">""</span>, <span class="co">#socio-demographic</span>
        <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">or.df</span><span class="op">$</span><span class="va">or</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span>, <span class="st">""</span>, <span class="co">#period</span>
        <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">or.df</span><span class="op">$</span><span class="va">or</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span>     <span class="co">#pre-existing condition</span>
        <span class="op">)</span>

<span class="co">#formatting OR values forestplot uses</span>
<span class="va">or</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,  
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">or</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="cn">NA</span>,<span class="co">#sex </span>
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">or</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="co">#socio-demographic</span>
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">or</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="co">#period</span>
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">or</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>     <span class="co">#pre-existing condition</span>
        <span class="op">)</span>

<span class="co">#formatting lower limit values forestplot uses</span>
<span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, 
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ll</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="co">#sex</span>
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ll</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="co">#socio-demographic</span>
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ll</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="co">#period</span>
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ll</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>     <span class="co">#pre-existing condition</span>
        <span class="op">)</span>

<span class="co">#formatting upper limit values forestplot uses</span>
<span class="va">ul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,  
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ul</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="co">#sex</span>
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ul</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="co">#socio-economic</span>
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ul</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="co">#period</span>
        <span class="cn">NA</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">ul</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="co">#pre-existing condition</span>
        <span class="op">)</span>

<span class="co">#formatting the categories and factor names</span>
<span class="va">factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, 
        <span class="st">"Sex"</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">factors</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="st">""</span>, <span class="co">#sex</span>
        <span class="st">"Socioeconomic condition"</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">factors</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="st">""</span>, <span class="co">#socio-demographic</span>
        <span class="st">"Period of pandemic"</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">factors</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, <span class="st">""</span>, <span class="co">#period</span>
        <span class="st">"Preexisting conditions"</span>, <span class="va">or.df</span><span class="op">$</span><span class="va">factors</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="co">#pre-existing condition</span>
        <span class="op">)</span></code></pre></div>
<p>Again, to make the plot more readable, we can specify which rows of the forest plot are bolded. We do so by creating a summary vector, which specifies the rows of the plot we want to highlight. In this case, we want to make the text on the headings and category titles stand out, so we create a vector of TRUE/FALSE that has value TRUE when we want bold text and FALSE otherwise.</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#specifying bolded text</span>
<span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fl">3</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fl">3</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fl">5</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="forest-plot" class="section level2" number="25.4">
<h2>
<span class="header-section-number">25.4</span> Forest Plot<a class="anchor" aria-label="anchor" href="#forest-plot"><i class="fas fa-link"></i></a>
</h2>
<p><em>forestplot()</em> takes a specific type of dataframe. We need to specify the mean (OR values), lower (lower limits of confidence intervals), upper (upper limits of confidence intervals), study (the factors), confint (the formatted confidence intervals <em>forestplot()</em> displays) and OR (the OR values <em>forestplot()</em> displays).</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">or</span>,
               lower <span class="op">=</span> <span class="va">ll</span>,
               upper <span class="op">=</span> <span class="va">ul</span>,
               study <span class="op">=</span> <span class="va">factors</span>,
               confint <span class="op">=</span> <span class="va">ci</span>,
               or <span class="op">=</span> <span class="va">or.char</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">forestplot</span><span class="op">(</span><span class="va">plot.data</span>, labeltext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">or</span>, <span class="va">confint</span><span class="op">)</span>,
             is.summary <span class="op">=</span> <span class="va">summary</span>,
             new_page <span class="op">=</span> <span class="cn">T</span>,
             col <span class="op">=</span> <span class="fu">fpColors</span><span class="op">(</span>box <span class="op">=</span> <span class="st">"royalblue"</span>,
                            line <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span>,
             txt_gp <span class="op">=</span> <span class="fu">fpTxtGp</span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">0.8</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span>, 
                              ticks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontsize<span class="op">=</span><span class="fl">5</span>, cex<span class="op">=</span><span class="fl">1.4</span><span class="op">)</span><span class="op">)</span>,
             graph.pos <span class="op">=</span> <span class="fl">2</span>,
             boxsize <span class="op">=</span> <span class="fl">0.2</span>,
             graphwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">45</span>, <span class="st">'mm'</span><span class="op">)</span>,
             title <span class="op">=</span> <span class="st">"Forest Plot of Mortality Rates"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="forest_plots_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></div>
<p>This plot looks fine, but the x-axis scale can be better because the confidence intervals range is not fully apparent. This can be fixed by changing the scale to logarithmic.</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">forestplot</span><span class="op">(</span><span class="va">plot.data</span>, labeltext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">or</span>, <span class="va">confint</span><span class="op">)</span>,
             xlog <span class="op">=</span> <span class="cn">TRUE</span>,
             is.summary <span class="op">=</span> <span class="va">summary</span>,
             new_page <span class="op">=</span> <span class="cn">T</span>,
             col <span class="op">=</span> <span class="fu">fpColors</span><span class="op">(</span>box <span class="op">=</span> <span class="st">"royalblue"</span>,
                            line <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span>,
             txt_gp <span class="op">=</span> <span class="fu">fpTxtGp</span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">0.8</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span>, 
                              ticks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontsize<span class="op">=</span><span class="fl">5</span>, cex<span class="op">=</span><span class="fl">1.4</span><span class="op">)</span><span class="op">)</span>,
             graph.pos <span class="op">=</span> <span class="fl">2</span>,
             boxsize <span class="op">=</span> <span class="fl">0.2</span>,
             graphwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">45</span>, <span class="st">'mm'</span><span class="op">)</span>,
             title <span class="op">=</span> <span class="st">"Forest Plot of Mortality Rates"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="forest_plots_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></div>
<p>This is better, but to make it even more clear, we can specify the x-axis ticks (using xticks) and clip the conidence interval range (using clip).</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">forestplot</span><span class="op">(</span><span class="va">plot.data</span>, labeltext <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">or</span>, <span class="va">confint</span><span class="op">)</span>,
             clip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">5</span><span class="op">)</span>,
             xticks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span>,
             xlog <span class="op">=</span> <span class="cn">TRUE</span>,
             is.summary <span class="op">=</span> <span class="va">summary</span>,
             new_page <span class="op">=</span> <span class="cn">T</span>,
             col <span class="op">=</span> <span class="fu">fpColors</span><span class="op">(</span>box <span class="op">=</span> <span class="st">"royalblue"</span>,
                            line <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span>,
             txt_gp <span class="op">=</span> <span class="fu">fpTxtGp</span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">0.8</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span>, 
                              ticks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontsize<span class="op">=</span><span class="fl">5</span>, cex<span class="op">=</span><span class="fl">1.4</span><span class="op">)</span><span class="op">)</span>,
             graph.pos <span class="op">=</span> <span class="fl">2</span>,
             boxsize <span class="op">=</span> <span class="fl">0.2</span>,
             graphwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">45</span>, <span class="st">'mm'</span><span class="op">)</span>,
             title <span class="op">=</span> <span class="st">"Forest Plot of Mortality Rates"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="forest_plots_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="understanding-forestplot-better" class="section level2" number="25.5">
<h2>
<span class="header-section-number">25.5</span> Understanding forestplot() better<a class="anchor" aria-label="anchor" href="#understanding-forestplot-better"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-figure"><img src="resources/forest_plot/visual.JPG"></div>
</div>
<div id="references-4" class="section level2" number="25.6">
<h2>
<span class="header-section-number">25.6</span> References<a class="anchor" aria-label="anchor" href="#references-4"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li><a href="https://www.sciencedirect.com/topics/medicine-and-dentistry/forest-plot" class="uri">https://www.sciencedirect.com/topics/medicine-and-dentistry/forest-plot</a></li>
<li><a href="https://en.wikipedia.org/wiki/Forest_plot" class="uri">https://en.wikipedia.org/wiki/Forest_plot</a></li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="animation-graphs-in-plot_ly-and-gganimate.html"><span class="header-section-number">24</span> Animation graphs in plot_ly and gganimate</a></div>
<div class="next"><a href="differences-between-some-packages-of-visualizaiton.html"><span class="header-section-number">26</span> Differences between some packages of visualizaiton</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#forest-plots"><span class="header-section-number">25</span> Forest Plots</a></li>
<li><a class="nav-link" href="#introduction-3"><span class="header-section-number">25.1</span> Introduction</a></li>
<li><a class="nav-link" href="#data"><span class="header-section-number">25.2</span> Data</a></li>
<li><a class="nav-link" href="#formatting"><span class="header-section-number">25.3</span> Formatting</a></li>
<li><a class="nav-link" href="#forest-plot"><span class="header-section-number">25.4</span> Forest Plot</a></li>
<li><a class="nav-link" href="#understanding-forestplot-better"><span class="header-section-number">25.5</span> Understanding forestplot() better</a></li>
<li><a class="nav-link" href="#references-4"><span class="header-section-number">25.6</span> References</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jtr13/cc22spring/blob/main/forest_plots.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jtr13/cc22spring/edit/main/forest_plots.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Community Contributions STAT GR 5293</strong>" was written by . It was last built on 2022-04-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
